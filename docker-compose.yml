services:  # ðŸ‘ˆ Here you define all the containers that should run together

  postgres:  # ðŸ‘ˆ First service: your PostgreSQL database
    image: postgres:15  # ðŸ‘ˆ Use the official Postgres image, version 15
    container_name: postgres_db  # ðŸ‘ˆ Optional: friendly name for the container
    environment:  # ðŸ‘ˆ Env vars passed to the container
      POSTGRES_DB: energydb  # ðŸ‘ˆ Create a database named 'energydb'
      POSTGRES_USER: postgres  # ðŸ‘ˆ DB username
      POSTGRES_PASSWORD: yourpassword  # ðŸ‘ˆ DB password
    ports:
      - "5432:5432"  # ðŸ‘ˆ Map host port 5432 to container port 5432 (Postgres default)

  app:  # ðŸ‘ˆ Second service: your Spring Boot app
    build: .  # ðŸ‘ˆ Build this container using the local Dockerfile in the current directory
    container_name: energy_app  # ðŸ‘ˆ Optional: friendly name
    ports:
      - "8080:8080"  # ðŸ‘ˆ Expose your app on localhost:8080
    depends_on:
      - postgres  # ðŸ‘ˆ Ensure Postgres starts before your app tries to connect
    environment:  # ðŸ‘ˆ Pass DB connection info to your app
      SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/energydb  # ðŸ‘ˆ Use Postgres service name for hostname
      SPRING_DATASOURCE_USERNAME: postgres
      SPRING_DATASOURCE_PASSWORD: yourpassword